<div fxFlex fxLayout="row" *ngIf="model" appFileDrop>

    <div fxFlex="400px" class="containerWithToolbar" fxLayout="column">
        <mat-toolbar fxFlex="none" color="app" fxLayout="row" fxLayoutAlign="start center">
            <img *ngIf="showLogo" src="assets/images/logo-blanc.svg" style="max-width:100%;height:30px;" />

            <div *ngIf="title" class="mat-diplay-1">{{ title }}</div>

            <div fxFlex></div>

            <mat-menu #changeMenu="matMenu" [overlapTrigger]="false">
                <button mat-menu-item (click)="suggestUpdate()" *ngIf="model.id">Suggérer une modification</button>
                <button mat-menu-item (click)="suggestDeletion()" *ngIf="model.id">Suggérer la suppression</button>
                <button mat-menu-item (click)="suggestCreation()" *ngIf="!model.id">Suggérer l'ajout</button>
            </mat-menu>

            <button mat-icon-button [matMenuTriggerFor]="changeMenu" matTooltip="Signaler un changement">
                <mat-icon>add_alert</mat-icon>
            </button>

            <button mat-icon-button (click)="create()" *ngIf="!model.id" matTooltip="Créer">
                <mat-icon>add</mat-icon>
            </button>
            <button mat-icon-button (click)="update()" *ngIf="isEdit() && model.id" matTooltip="Enregistrer">
                <mat-icon>save</mat-icon>
            </button>
            <button mat-icon-button (click)="toggleEdit()" *ngIf="model.id" [matTooltip]="'Passer en mode édition'">
                <mat-icon>edit</mat-icon>
            </button>
            <button mat-icon-button color="warn" (click)="confirmDelete()" matTooltip="Supprimer">
                <mat-icon>delete_forever</mat-icon>
            </button>
        </mat-toolbar>

        <perfect-scrollbar fxFlex>
            <div fxLayout="column" class="padding-top scrolled" fxLayoutAlign="start stretch">

                <!--<div class="innerSpacing" fxLayout="column">-->
                    <!--<div fxLayout="row">Visible {{ statuses[status].text }}</div>-->
                    <!--<mat-slider [disabled]="!isEdit()"-->
                                <!--[min]="1"-->
                                <!--[max]="3"-->
                                <!--[ngModel]="status"-->
                                <!--(input)="updateStatus($event);status = $event.value"-->
                                <!--[color]="statuses[status].color"-->
                    <!--&gt;</mat-slider>-->
                <!--</div>-->

                <div class="innerSpacing" fxLayout="column">
                    <div fxLayout="row">Visible {{ visibilities[visibility].text }}</div>
                    <mat-slider [disabled]="!isEdit()"
                                [min]="1"
                                [max]="3"
                                [ngModel]="visibility"
                                (input)="updateVisibility($event);visibility = $event.value"
                                [color]="visibilities[visibility].color"
                    ></mat-slider>
                </div>

                <mat-form-field class="innerSpacing">
                    <input [readonly]="!isEdit()"
                           matInput
                           [(ngModel)]="model.name"
                           placeholder="Titre"
                           matTooltipPosition="after"
                           [matTooltip]="!isEdit() ? '' : 'Maecenas sed diam eget risus varius blandit sit amet non magna. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec ullamcorper nulla non metus auctor fringilla.'"
                    >
                </mat-form-field>

                <mat-form-field class="innerSpacing">
                    <input [readonly]="!isEdit()"
                           matInput
                           [(ngModel)]="model.expandedName"
                           placeholder="Titre étendu"
                           matTooltipPosition="after"
                           [matTooltip]="!isEdit() ? '' : 'Maecenas sed diam eget risus varius blandit sit amet non magna. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec ullamcorper nulla non metus auctor fringilla.'"
                    >
                </mat-form-field>

                <app-thesaurus [readonly]="!isEdit()"
                               [service]="artistService"
                               placeholder="Artistes"
                               [model]="model.artists"
                               (modelChange)="model.artists = $event"
                               [previewComponent]="artistComponent"
                ></app-thesaurus>

                <mat-form-field class="innerSpacing">
                    <input [readonly]="!isEdit()"
                           matInput
                           [(ngModel)]="model.addition"
                           placeholder="Supplément"
                           matTooltipPosition="after"
                           [matTooltip]="!isEdit() ? '' : 'Maecenas sed diam eget risus varius blandit sit amet non magna. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec ullamcorper nulla non metus auctor fringilla.'"
                    >
                </mat-form-field>

                <mat-form-field class="innerSpacing">
                    <input [readonly]="!isEdit()" matInput [(ngModel)]="model.technique" placeholder="Technique" >
                </mat-form-field>

                <mat-form-field class="innerSpacing">
                    <input [readonly]="!isEdit()" matInput [(ngModel)]="model.techniqueAuthor" placeholder="Auteur technique" >
                </mat-form-field>

                <mat-form-field class="innerSpacing">
                    <input [readonly]="!isEdit()"
                           matInput
                           [(ngModel)]="model.dating"
                           placeholder="Datation"
                           matTooltipPosition="after"
                           [matTooltip]="!isEdit() ? '' : 'Maecenas sed diam eget risus varius blandit sit amet non magna. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec ullamcorper nulla non metus auctor fringilla.'"
                    >
                </mat-form-field>

                <mat-form-field class="innerSpacing">
                    <input [readonly]="!isEdit()"
                           matInput
                           [(ngModel)]="model.material"
                           placeholder="Matériel"
                           matTooltipPosition="after"
                           [matTooltip]="!isEdit() ? '' : 'Maecenas sed diam eget risus varius blandit sit amet non magna. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec ullamcorper nulla non metus auctor fringilla.'"
                    >
                </mat-form-field>

                <mat-form-field class="innerSpacing">
                    <input [readonly]="!isEdit()"
                           matInput
                           [(ngModel)]="model.literature"
                           placeholder="Source"
                           matTooltipPosition="after"
                           [matTooltip]="!isEdit() ? '' : 'Maecenas sed diam eget risus varius blandit sit amet non magna. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec ullamcorper nulla non metus auctor fringilla.'"
                    >
                </mat-form-field>

                <mat-form-field class="innerSpacing">
                    <input [readonly]="!isEdit()" matInput [(ngModel)]="model.page" placeholder="Page" >
                </mat-form-field>

                <mat-form-field class="innerSpacing">
                    <input [readonly]="!isEdit()" matInput [(ngModel)]="model.figure" placeholder="Figure" >
                </mat-form-field>

                <mat-form-field class="innerSpacing">
                    <input [readonly]="!isEdit()" matInput [(ngModel)]="model.table" placeholder="Planche" >
                </mat-form-field>

                <mat-form-field class="innerSpacing">
                    <input [readonly]="!isEdit()"
                           matInput
                           [(ngModel)]="model.isbn"
                           placeholder="ISBN"
                           matTooltipPosition="after"
                           [matTooltip]="!isEdit() ? '' : 'Maecenas sed diam eget risus varius blandit sit amet non magna. Cum sociis natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Donec ullamcorper nulla non metus auctor fringilla.'"
                    >
                </mat-form-field>

                <div class="mat-title innerSpacing">Lieu</div>

                <app-thesaurus [readonly]="!isEdit()"
                               [service]="institutionSvc"
                               placeholder="Institution"
                               [model]="model.institution"
                               (modelChange)="model.institution = $event"
                               [multiple]="false"
                               [previewComponent]="institutionComponent"
                ></app-thesaurus>

                <app-address [(model)]="model" [vertical]="true" [readonly]="!isEdit()"></app-address>
            </div>

        </perfect-scrollbar>

        <div class="padding mat-elevation-z4">
            <app-stamp [item]="model"></app-stamp>
        </div>

    </div>

    <div fxFlex class="containerWithToolbar" fxLayout="column" >
        <mat-toolbar fxFlex="none" color="app" fxLayout="row" fxLayoutAlign="start center">
            <div fxFlex></div>
            <a *ngIf="imageSrcFull && !imageData" mat-icon-button [attr.href]="imageSrcFull" download matTooltip="Télécharger l'image">
                <mat-icon>file_download</mat-icon>
            </a>
        </mat-toolbar>
        <div *ngIf="imageSrc && !imageData" class="image" fxFlex [ngStyle]="{'background-image': 'url(' + imageSrc + ')'}"></div>
        <div *ngIf="imageData" class="image" fxFlex [ngStyle]="{'background-image': 'url(data:image;base64,' + imageData + ')'}"></div>
    </div>

</div>
