<div fxFlex fxLayout="row">

    <div fxFlex="400px" class="containerWithToolbar" fxLayout="column">
        <mat-toolbar fxFlex="none" color="app" fxLayout="row" fxLayoutAlign="start center">
            <img src="assets/images/logo-bleu.svg" style="max-width:100%;height:30px;" />
            <div fxFlex></div>

            <mat-form-field fxFlex class="searchField width-auto no-padding" floatPlaceholder="never">
                <input matInput
                       appFocus
                       placeholder="Rechercher"
                       [ngModel]="searchedTerm"
                       (change)="search($event.target.value)"
                       (keyup.esc)="search('')"
                >
                <mat-icon matPrefix>search</mat-icon>
                <button mat-icon-button matSuffix (click)="search('')">
                    <mat-icon>close</mat-icon>
                </button>
            </mat-form-field>

            <button mat-icon-button (click)="add()" [matTooltip]="'Créer une collection'" *ngIf="canCreate">
                <mat-icon>add</mat-icon>
            </button>
        </mat-toolbar>

        <perfect-scrollbar>
            <div fxLayout="column" class="scrolled">

                <mat-nav-list *ngIf="showUnclassified">
                    <a mat-list-item [routerLink]="['.']" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }">
                        <mat-icon mat-list-icon>collections</mat-icon>
                        <span matLine fxLayout="row" fxLayoutAlign="start center">Non classé</span>
                    </a>
                </mat-nav-list>

                <mat-nav-list *ngIf="showMyCards">
                    <a mat-list-item [routerLink]="['my-cards']" routerLinkActive="active" [routerLinkActiveOptions]="{ exact: true }">
                        <mat-icon mat-list-icon>collections</mat-icon>
                        <span matLine fxLayout="row" fxLayoutAlign="start center">Mes images</span>
                    </a>
                </mat-nav-list>

                <mat-divider *ngIf="showUnclassified"></mat-divider>

                <mat-nav-list *ngIf="collections">
                    <ng-container *ngFor="let item of collections">
                        <a mat-list-item [routerLink]="item.id" routerLinkActive="active">
                            <mat-icon mat-list-icon>collections</mat-icon>
                            <span matLine fxLayout="row" fxLayoutAlign="start center">{{ item.name }}</span>
                            <button mat-icon-button (click)="edit($event, item)">
                                <mat-icon>edit</mat-icon>
                            </button>
                        </a>


                        <ng-container *ngFor="let item of item.children">
                            <a mat-list-item [routerLink]="item.id" routerLinkActive="active" style="padding-left:20px;">
                                <mat-icon mat-list-icon>collections</mat-icon>
                                <span matLine fxLayout="row" fxLayoutAlign="start center">{{ item.name }}</span>
                                <button mat-icon-button (click)="edit($event, item)">
                                    <mat-icon>edit</mat-icon>
                                </button>
                            </a>

                            <ng-container *ngFor="let item of item.children">
                                <a mat-list-item [routerLink]="item.id" routerLinkActive="active" style="padding-left:40px;">
                                    <mat-icon mat-list-icon>collections</mat-icon>
                                    <span matLine fxLayout="row" fxLayoutAlign="start center">{{ item.name }}</span>
                                    <button mat-icon-button (click)="edit($event, item)">
                                        <mat-icon>edit</mat-icon>
                                    </button>
                                </a>

                                <ng-container *ngFor="let item of item.children">
                                    <a mat-list-item [routerLink]="item.id" routerLinkActive="active" style="padding-left:60px;">
                                        <mat-icon mat-list-icon>collections</mat-icon>
                                        <span matLine fxLayout="row" fxLayoutAlign="start center">{{ item.name }}</span>
                                        <button mat-icon-button (click)="edit($event, item)">
                                            <mat-icon>edit</mat-icon>
                                        </button>
                                    </a>
                                </ng-container>

                            </ng-container>

                        </ng-container>

                    </ng-container>
                    <a mat-list-item (click)="more()" *ngIf="hasMore" fxLayout="column" fxLayoutAlign="center">
                        <mat-icon mat-list-icon>keyboard_arrow_down</mat-icon>
                        <span matLine>Afficher d'avantage</span>
                    </a>
                </mat-nav-list>
            </div>
        </perfect-scrollbar>
    </div>

    <router-outlet></router-outlet>

</div>
